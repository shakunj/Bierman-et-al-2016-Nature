clear all

%% Load input files
load P10 % sea-level high-latitude 10Be prod rate (atoms/g/yr) in 1 cm depth steps from 0 to 740 m
load P26 % sea-level high-latitude 26Al prod rate (atoms/g/yr) in 1 cm depth steps from 0 to 740 m
load steadystate_10Be_20mMyr % sea-level high-latitude 10Be steady state depth profile in 1 cm depth steps from 0 to 700 m assuming 20 m/Myr erosion rate
load steadystate_26Al_20mMyr % sea-level high-latitude 26Al steady state depth profile in 1 cm depth steps from 0 to 700 m assuming 20 m/Myr erosion rate
load LR04 % LR04 benthic d18O stack over the past 5.3 Myr in 2 kyr time steps from Lisiecki and Raymo, 2005, Paleoceanography
LR04 = flipud(LR04);
load er_half_Ma % indices switching which set of depth profiles are under warm vs. cold based ice cover every 500 kyr
f = 20; % erosion rate under warm based ice in m/Myr
f2 = 20; % subaerial erosion rate in m/Myr
er = er_half_Ma*f; 

%% Create two sets of 10 bedrock 10Be and 26Al profiles (one set to be under warm based ice while the other is under cold based ice, and vice versa)
z = [0:15000]'; % depth range to model in cm
bedrock_10Be = [steadystate_10Be_20mMyr(1:length(z)+f/5)];
bedrock_26Al = [steadystate_26Al_20mMyr(1:length(z)+f/5)];

bedrock_10Be_100a = bedrock_10Be; % bedrock covered when the ice sheet is at 90-100%
bedrock_10Be_90a = bedrock_10Be; % bedrock covered when the ice sheet is at 80-90%
bedrock_10Be_80a = bedrock_10Be; % bedrock covered when the ice sheet is at 70-80%
bedrock_10Be_70a = bedrock_10Be; % bedrock covered when the ice sheet is at 60-70%
bedrock_10Be_60a = bedrock_10Be; % bedrock covered when the ice sheet is at 50-60%
bedrock_10Be_50a = bedrock_10Be; % bedrock covered when the ice sheet is at 40-50%
bedrock_10Be_40a = bedrock_10Be; % bedrock covered when the ice sheet is at 30-40%
bedrock_10Be_30a = bedrock_10Be; % bedrock covered when the ice sheet is at 20-30%
bedrock_10Be_20a = bedrock_10Be; % bedrock covered when the ice sheet is at 10-20%
bedrock_10Be_10a = bedrock_10Be; % bedrock covered when the ice sheet is at 0-10%

bedrock_10Be_100b = bedrock_10Be; % bedrock covered when the ice sheet is at 90-100%
bedrock_10Be_90b = bedrock_10Be; % bedrock covered when the ice sheet is at 80-90%
bedrock_10Be_80b = bedrock_10Be; % bedrock covered when the ice sheet is at 70-80%
bedrock_10Be_70b = bedrock_10Be; % bedrock covered when the ice sheet is at 60-70%
bedrock_10Be_60b = bedrock_10Be; % bedrock covered when the ice sheet is at 50-60%
bedrock_10Be_50b = bedrock_10Be; % bedrock covered when the ice sheet is at 40-50%
bedrock_10Be_40b = bedrock_10Be; % bedrock covered when the ice sheet is at 30-40%
bedrock_10Be_30b = bedrock_10Be; % bedrock covered when the ice sheet is at 20-30%
bedrock_10Be_20b = bedrock_10Be; % bedrock covered when the ice sheet is at 10-20%
bedrock_10Be_10b = bedrock_10Be; % bedrock covered when the ice sheet is at 0-10%

bedrock_26Al_100a = bedrock_26Al; % bedrock covered when the ice sheet is at 90-100%
bedrock_26Al_90a = bedrock_26Al; % bedrock covered when the ice sheet is at 80-90%
bedrock_26Al_80a = bedrock_26Al; % bedrock covered when the ice sheet is at 70-80%
bedrock_26Al_70a = bedrock_26Al; % bedrock covered when the ice sheet is at 60-70%
bedrock_26Al_60a = bedrock_26Al; % bedrock covered when the ice sheet is at 50-60%
bedrock_26Al_50a = bedrock_26Al; % bedrock covered when the ice sheet is at 40-50%
bedrock_26Al_40a = bedrock_26Al; % bedrock covered when the ice sheet is at 30-40%
bedrock_26Al_30a = bedrock_26Al; % bedrock covered when the ice sheet is at 20-30%
bedrock_26Al_20a = bedrock_26Al; % bedrock covered when the ice sheet is at 10-20%
bedrock_26Al_10a = bedrock_26Al; % bedrock covered when the ice sheet is at 0-10%

bedrock_26Al_100b = bedrock_26Al; % bedrock covered when the ice sheet is at 90-100%
bedrock_26Al_90b = bedrock_26Al; % bedrock covered when the ice sheet is at 80-90%
bedrock_26Al_80b = bedrock_26Al; % bedrock covered when the ice sheet is at 70-80%
bedrock_26Al_70b = bedrock_26Al; % bedrock covered when the ice sheet is at 60-70%
bedrock_26Al_60b = bedrock_26Al; % bedrock covered when the ice sheet is at 50-60%
bedrock_26Al_50b = bedrock_26Al; % bedrock covered when the ice sheet is at 40-50%
bedrock_26Al_40b = bedrock_26Al; % bedrock covered when the ice sheet is at 30-40%
bedrock_26Al_30b = bedrock_26Al; % bedrock covered when the ice sheet is at 20-30%
bedrock_26Al_20b = bedrock_26Al; % bedrock covered when the ice sheet is at 10-20%
bedrock_26Al_10b = bedrock_26Al; % bedrock covered when the ice sheet is at 0-10%

IRD_10Be = []; % empty matrix to be filled with 10Be concentrations of bedrock eroded by ice sheet at each time step
IRD_26Al = []; % empty matrix to be filled with 26Al concentrations of bedrock eroded beneath ice sheet at each time step

%% Run model 
for t = 1:1:2651 % time steps in 2 ky (i.e., from 0-5300 ka)
        if LR04(t,2) <= 2.6 % 0-10% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_20a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_20a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_30a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_30a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_20b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_20b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_30b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_30b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f)];
        IRD_26Al = [IRD_26Al; mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f)];
        
        elseif LR04(t,2) <= 2.71 % 10-20% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_30a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_30a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_30b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_30b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 2.82 % 20-30% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_40b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 2.93 % 30-40% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_50b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 3.04 % 40-50% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_60b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 3.15 % 50-60% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_70b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_60a(1:f/5,t)*er(t,1)/f+bedrock_10Be_60b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_60a(1:f/5,t)*er(t,1)/f+bedrock_26Al_60b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 3.26 % 60-70% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_80b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_60a(1:f/5,t)*er(t,1)/f+bedrock_10Be_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_70a(1:f/5,t)*er(t,1)/f+bedrock_10Be_70b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_60a(1:f/5,t)*er(t,1)/f+bedrock_26Al_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_70a(1:f/5,t)*er(t,1)/f+bedrock_26Al_70b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 3.37 % 70-80% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_90b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_60a(1:f/5,t)*er(t,1)/f+bedrock_10Be_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_70a(1:f/5,t)*er(t,1)/f+bedrock_10Be_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_80a(1:f/5,t)*er(t,1)/f+bedrock_10Be_80b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_60a(1:f/5,t)*er(t,1)/f+bedrock_26Al_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_70a(1:f/5,t)*er(t,1)/f+bedrock_26Al_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_80a(1:f/5,t)*er(t,1)/f+bedrock_26Al_80b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) <= 3.48 % 80-90% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_90a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_90a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100a(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_90b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_90b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = P10(1+f2/5:length(z)+f2/5)*2000 + (bedrock_10Be_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = P26(1+f2/5:length(z)+f2/5)*2000 + (bedrock_26Al_100b(1+f2/5:length(z)+f2/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_60a(1:f/5,t)*er(t,1)/f+bedrock_10Be_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_70a(1:f/5,t)*er(t,1)/f+bedrock_10Be_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_80a(1:f/5,t)*er(t,1)/f+bedrock_10Be_80b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_90a(1:f/5,t)*er(t,1)/f+bedrock_10Be_90b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_60a(1:f/5,t)*er(t,1)/f+bedrock_26Al_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_70a(1:f/5,t)*er(t,1)/f+bedrock_26Al_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_80a(1:f/5,t)*er(t,1)/f+bedrock_26Al_80b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_90a(1:f/5,t)*er(t,1)/f+bedrock_26Al_90b(1:f/5,t)*er(t,2)/f)])];
        
        elseif LR04(t,2) > 3.48 % 90-100% ice cover
        bedrock_10Be_10a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_10a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_20a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_30a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_40a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_50a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_60a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_70a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_80a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_90a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_90a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100a(1:length(z),t+1) = 0*P10(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_10Be_100a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100a(1:length(z),t+1) = 0*P26(1+er(t,1)/5:length(z)+er(t,1)/5)*2000 + (bedrock_26Al_100a(1+er(t,1)/5:length(z)+er(t,1)/5,t)*exp(-1*9.83e-7*2000));
        
        bedrock_10Be_10b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_10b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_10b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_20b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_20b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_20b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_30b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_30b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_30b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_40b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_40b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_40b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_50b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_50b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_50b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_60b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_60b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_60b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_70b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_70b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_70b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_80b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_80b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_80b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));  
        bedrock_10Be_90b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_90b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_90b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_90b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        bedrock_10Be_100b(1:length(z),t+1) = 0*P10(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_10Be_100b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*4.99e-7*2000));
        bedrock_26Al_100b(1:length(z),t+1) = 0*P26(1+er(t,2)/5:length(z)+er(t,2)/5)*2000 + (bedrock_26Al_100b(1+er(t,2)/5:length(z)+er(t,2)/5,t)*exp(-1*9.83e-7*2000));
        
        IRD_10Be = [IRD_10Be; mean([mean(bedrock_10Be_10a(1:f/5,t)*er(t,1)/f+bedrock_10Be_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_20a(1:f/5,t)*er(t,1)/f+bedrock_10Be_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_30a(1:f/5,t)*er(t,1)/f+bedrock_10Be_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_40a(1:f/5,t)*er(t,1)/f+bedrock_10Be_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_50a(1:f/5,t)*er(t,1)/f+bedrock_10Be_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_60a(1:f/5,t)*er(t,1)/f+bedrock_10Be_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_70a(1:f/5,t)*er(t,1)/f+bedrock_10Be_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_80a(1:f/5,t)*er(t,1)/f+bedrock_10Be_80b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_90a(1:f/5,t)*er(t,1)/f+bedrock_10Be_90b(1:f/5,t)*er(t,2)/f) mean(bedrock_10Be_100a(1:f/5,t)*er(t,1)/f+bedrock_10Be_100b(1:f/5,t)*er(t,2)/f)])];
        IRD_26Al = [IRD_26Al; mean([mean(bedrock_26Al_10a(1:f/5,t)*er(t,1)/f+bedrock_26Al_10b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_20a(1:f/5,t)*er(t,1)/f+bedrock_26Al_20b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_30a(1:f/5,t)*er(t,1)/f+bedrock_26Al_30b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_40a(1:f/5,t)*er(t,1)/f+bedrock_26Al_40b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_50a(1:f/5,t)*er(t,1)/f+bedrock_26Al_50b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_60a(1:f/5,t)*er(t,1)/f+bedrock_26Al_60b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_70a(1:f/5,t)*er(t,1)/f+bedrock_26Al_70b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_80a(1:f/5,t)*er(t,1)/f+bedrock_26Al_80b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_90a(1:f/5,t)*er(t,1)/f+bedrock_26Al_90b(1:f/5,t)*er(t,2)/f) mean(bedrock_26Al_100a(1:f/5,t)*er(t,1)/f+bedrock_26Al_100b(1:f/5,t)*er(t,2)/f)])];
        end
end